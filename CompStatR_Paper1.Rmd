---
title: "Paper1"
author: "Group13"
date: "4 listopada 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part I (3 points)

1. What are the atomic vector types in R? Explain which value they can take and give an example!
*Answer:* "logical", "integer", "numeric" (synonym "double"), "complex", "character" and "raw"

2. What is the difference between generic and atomic vectors?
*Answer:*atomic vector is a simplest R data type, is a linear vector of a single primitive type and generic vector includes different semantics. Generic vector is another expression for a list.
3. Explain the following statement:
A data frame is a list, but not every list is a data frame.
Answer: Data frame is a structure which consists of atomic vectors of one type of  and inside a list (generic vector) the elements can be of different kind for example numerical, factor, string altogether at once. 

## Part II (7 points)
Explain each line of the following code. In addition, discuss what the output of identical(a, b)
will be. Check the help files for the functions set.seed, identical, rnorm and cumsum.

```{r}
# sets the seed for random number generator in order to get reproducibility of the randomness for later use, ensures gettin the same result
set.seed(1)
#defines vector of random variables of size 100000000 generated from normal distribution with mean=5 and standard deviation=10
largeVector <- rnorm(1e8, mean =5, sd =10) 
#defines variable a to be a vector of cumulative sums of the first 100 variables of largeVector 
a <- cumsum(largeVector)[1:100] 
#defines variable b to be a vector of cumulative sums of the first 100 variables of largeVector
b <- cumsum(largeVector[1:100])
#checks if variable a&b are the same, returns logical value
identical(a, b)
```
system.time returns the time elapsed for the computation. Explain the differences:

```{r}
#calculates the time necessary to compute the cumulative sum of largeVector in order to determine which way of coding is the most efficient
system.time(cumsum(largeVector)[1:100])
```
```{r}
#command is faster because it calculates only first 100 elements and not the whole vector of 100000000
system.time(cumsum(largeVector[1:100]))
```
## Part III (20 points)
Conduct a regression analysis and report your findings. The report should contain the following
sections:
• data import
• descriptive statistics and data validation
• identification of relevant regressors
• fitting a regression model
• discussion of model fit, e.g. goodness of fit, significance of regressors
• interpreting the model
```{r}
load(file = "titanic.Rdata")
#Size of dataframe
paste('Dimension of titanic dataframe',dim(titanic))
#summary statistics for each variable
summary(titanic)
#check the data type of each variable
sapply(titanic,typeof)
```
```{r}
#cleaning the data, impute NA for missing values to get consistency of the dataset
data<-titanic
data[data==""]<-NA #insert NA for missing values
data$name=NULL#deleting name from data frame
```
#descriptive analysis: correlation matrix
```{r}
datacor<-data[1:8] #select the variables:pclass,survived,sex,age,sibsp,parch the rest seems to be irrelevant and hard to interpret
datacor$ticket<-NULL
datacor$cabin=NULL #delete cabin as it has too many na's
#chnaging pclass into integer
datacor$pclass<-as.character(datacor$pclass)
datacor$pclass[datacor$pclass=="1st"]<-1
datacor$pclass[datacor$pclass=="2nd"]<-2
datacor$pclass[datacor$pclass=="3rd"]<-3
datacor$pclass<-as.integer(datacor$pclass)
#changing sex into integer:1 for male, 0 for female
datacor$sex<-as.character(datacor$sex)
datacor$sex[datacor$sex=="male"]<-1
datacor$sex[datacor$sex=="female"]<-0
datacor$sex<-as.integer(datacor$sex)
#calculate correlation 
cor(na.omit(datacor))
```
Summary of the correlations:
1. class and the survived is negatively correlated which means, the lower class the passenger was the less chance of survival one had
2.As we may expected before fare is negatively correlated with the pclass, so it means the the lower the price of the ticket the worse/lower class, which also proofs that the higher the fare it is more likely to survive due to positive relation between fare and survived
3.Taking look at the sex and survived we can notice that it is correlated negatively, in other words male passenger were more likely to die (having in mind that 1=male, 0=female)
# Some statistics about the data

```{r}
datatable<-na.omit(datacor[1:3])
table(datatable)
prop.table(table(datatable$pclass))
```
Conclusions:
1.Most of the passengers (75-79%) from 1st and 2nd class survived, for third class only the half
2.Female passengers were more likely to survive than male
```{r,echo=TRUE}
prop.table(table(datatable$survived))
```
38% of the passengers survived the titanic's diseaster
```{r}
prop.table(table(datatable$sex))
```
64% of the all passengers were male
```{r}
dataglm<-na.omit(subset(titanic, select=c(1,2,4,5,6,7,9)))
model<-glm(survived ~., family = binomial(link="logit"),data=dataglm)
summary(model)
```
**Interpretation:**
All variables except from Number of Parents/Children Aboard and Passenger Fare are statistically significant. Passenger Classes confirm the negative relation, the lower the class from 1st to 3rd the less likely is to survive. The same with sex, male are more likely to die and the older the passenger was the lower chances one had. For more precise interpretation the model coefficient should be transformed in exponential

#Recalculate the model
```{r}
#recalculate the model without parch and fare 
#as they are not statistically significant
dataglm2<-dataglm[1:5]
model2<-glm(survived ~., family = binomial(link="logit"),data=dataglm2)
summary(model2)
#changing to exponential for better interpretation
exp(coef(model2))
```

**Final Interpretation**
Being a woman from 1st class, the odds of survival increases by a factor 51,7. 


#Plot of the model
```{r}
plot(model2)
```

